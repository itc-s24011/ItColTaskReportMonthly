# ItCol 月次作業報告ツール

プロジェクト作業時間を計測・集計し、月次レポートを作成するWebアプリケーション

## 主な機能

### M-1. タスク登録フォーム
- **プロジェクト名**: 必須入力、最大100文字
- **カテゴリ選択**: プルダウン（開発、会議、メール、調査、その他）
- **メモ**: 任意入力、最大500文字
- **データベース項目**: `task_name`, `category`, `memo`, `created_date`

### M-2. タイマー機能
- **START/STOPボタン**: 作業時間の計測開始・停止
- **経過時間表示**: リアルタイムで時間表示（hh:mm:ss形式）
- **データ記録**: 開始時刻、終了時刻、作業時間（秒単位）をDBに保存
- **データベース項目**: `start_time`, `end_time`, `duration_seconds`

### M-3. 月次集計機能
- **集計期間選択**: 年月をプルダウンで選択
- **総作業時間表示**: 選択月の総作業時間（h単位、小数点1桁）
- **総作業日数表示**: 選択月の実働日数
- **SQL集計**: GROUP BY, SUM関数を使用した集計クエリ

### M-4. プロジェクト別一覧表示
- **表示項目**: プロジェクト名、作業時間、割合（%）
- **ソート**: 作業時間の降順
- **一行表示**: 1プロジェクト＝1行、縦スクロール対応
- **レイアウト**: A4縦印刷を想定したテーブルレイアウト

### M-5. カテゴリ別集計
- **集計軸切替**: プロジェクト別／カテゴリ別の表示切替
- **表示内容**: M-4と同様の形式でカテゴリ別に集計

### M-6. 印刷対応（CSS）
- **印刷用CSS**: `@media print` を使用
- **A4縦サイズ**: ページ内に収まるレイアウト
- **不要要素非表示**: ボタン、ナビゲーションなどを非表示

## セットアップと起動方法

### 1. 仮想環境のセットアップ

```bash
cd /home/neha11/ItColTaskReportMonthly/ItColTaskReportMonthly

# 仮想環境を作成（初回のみ）
python3 -m venv venv

# 仮想環境を有効化
source venv/bin/activate

# 依存パッケージをインストール（初回のみ）
pip install flask flask-sqlalchemy
```

### 2. アプリケーションの起動

```bash
# 仮想環境が有効化された状態で
python3 app.py
```

または、仮想環境を有効化せずに直接実行：

```bash
/home/neha11/ItColTaskReportMonthly/ItColTaskReportMonthly/venv/bin/python3 app.py
```

### 3. ブラウザでアクセス

```
http://127.0.0.1:5000
```

## 使い方

### タスク登録・実行画面（トップページ）

1. **新規タスク登録**
   - プロジェクト名を入力
   - カテゴリを選択（開発、会議、メール、調査、その他）
   - メモを入力（任意）
   - 「タスクを追加」ボタンをクリック

2. **タイマーの操作**
   - **START**: タスクの作業時間計測を開始
   - **STOP**: 作業時間計測を停止
   - 経過時間はリアルタイムで更新されます

3. **タスクの編集・削除**
   - **編集**: タスク情報を変更
   - **削除**: タスクを削除（確認ダイアログが表示されます）

### 月次レポート画面

1. **期間選択**
   - 年と月をプルダウンから選択
   - 自動的に集計結果が更新されます

2. **表示切替**
   - **プロジェクト別**: プロジェクトごとの作業時間を表示
   - **カテゴリ別**: カテゴリごとの作業時間を表示

3. **印刷**
   - 「印刷」ボタンをクリック
   - A4縦サイズで印刷プレビューが表示されます
   - 不要な要素（ボタン、ナビゲーション）は自動的に非表示になります

## データベース構造

### Taskテーブル

| カラム名 | 型 | 説明 |
|---------|-----|------|
| id | INTEGER | 主キー（自動採番） |
| task_name | VARCHAR(100) | プロジェクト名 |
| category | VARCHAR(50) | カテゴリ（開発、会議、メール、調査、その他） |
| memo | VARCHAR(500) | メモ |
| created_date | DATE | 作成日 |
| start_time | DATETIME | 開始時刻 |
| end_time | DATETIME | 終了時刻 |
| duration_seconds | INTEGER | 作業時間（秒単位） |
| is_running | BOOLEAN | タイマー実行中フラグ |

## 画面構成

### タスク登録・実行画面
- 日付と当日の総作業時間を表示
- タスク登録フォーム（プロジェクト名、カテゴリ、メモ）
- 今日のタスク一覧
- タイマー機能（START/STOP）
- 編集・削除ボタン

### 月次レポート画面
- 年月選択
- 総作業日数・総作業時間の表示
- プロジェクト別/カテゴリ別の集計テーブル
- 横棒グラフ（割合の可視化）
- 印刷ボタン

## デザイン特徴

- **モノクロ基調**: 濃淡グレーのみで構成し、印刷やモノクロ表示に最適化
- **レスポンシブデザイン**: モバイル・タブレット・デスクトップに対応
- **カテゴリ区別**: 濃淡グレーのタグでカテゴリを判別
- **印刷最適化**: A4縦サイズで視認性を確保

## 技術スタック

- **バックエンド**: Flask 3.1.2
- **データベース**: SQLAlchemy（SQLite/PostgreSQL対応）
- **フロントエンド**: HTML5, CSS3, JavaScript
- **デザイン**: レスポンシブデザイン、印刷用CSS

## 開発者向け情報

### プロジェクト構造

```
ItColTaskReportMonthly/
├── app.py                    # メインアプリケーション
├── requirements.txt          # 依存パッケージ
├── venv/                     # Python仮想環境
├── instance/
│   └── db.sqlite            # SQLiteデータベース
├── static/
│   └── style.css            # CSSスタイル
├── templates/
│   ├── index.html           # タスク登録画面
│   └── report.html          # 月次レポート画面
└── docs/
    ├── external_design.html  # 外部設計書
    └── images/
        ├── ui_task_entry.png       # タスク登録画面UI
        └── ui_monthly_report.png   # 月次レポート画面UI
```

### データベース切り替え

デフォルトはSQLiteですが、PostgreSQLに切り替えることも可能です：

```bash
export USE_POSTGRESQL=1
python3 app.py
```

PostgreSQLの設定:
- データベース名: `todo_db`
- ユーザー名: `todo_user`
- パスワード: `todo_password`
- ホスト: `localhost`

## トラブルシューティング

### Flaskが起動しない

```bash
# 仮想環境を再作成
rm -rf venv
python3 -m venv venv
source venv/bin/activate
pip install flask flask-sqlalchemy
```

### データベースをリセットしたい

```bash
rm -f instance/db.sqlite
python3 app.py  # 再起動時に自動作成されます
```

### ポート5000が使用中

```python
# app.py の最後の行を変更
app.run(debug=True, port=5001)
```

## ライセンス

このプロジェクトは教育目的で作成されています。

## 開発者

IT専門学生 6名による共同開発プロジェクト

---

**作成日**: 2025年12月15日  
**バージョン**: 1.0.0
